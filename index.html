<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SCHEDULE GANTT CHART</title>

  <!-- Tailwind (for bg-xxx utility classes used in bars) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Poppins -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

  <!-- SheetJS -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <link rel="stylesheet" href="./styles.css" />
</head>

<body class="bg-slate-50 text-slate-800" style="font-family: 'Poppins', sans-serif;">
  <div class="max-w-full mx-auto bg-white rounded-xl shadow-xl overflow-hidden border border-slate-200">

    <!-- Header Info -->
    <div class="p-5 bg-slate-50 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 border-b border-slate-200">
      <div>
        <h1 class="text-2xl font-black tracking-tight flex items-center gap-2 text-slate-900">
          <span class="text-amber-600">SCHEDULE</span> GANTT CHART
        </h1>
        <p class="text-slate-500 text-xs uppercase tracking-widest font-semibold mt-1">
          Upload Excel (copy/paste from P6) • Indentation preserved = hierarchy
        </p>
      </div>

      <div class="flex gap-6 text-xs bg-white p-3 rounded-lg border border-slate-200 shadow-sm">
        <div class="text-center">
          <span class="block text-slate-500 uppercase tracking-wider mb-1">Commencement</span>
          <span id="commDate" class="font-bold text-emerald-600">—</span>
        </div>
        <div class="w-px h-8 bg-slate-200"></div>
        <div class="text-center">
          <span class="block text-slate-500 uppercase tracking-wider mb-1">Total Duration</span>
          <span id="totalDur" class="font-bold text-slate-800">—</span>
        </div>
        <div class="w-px h-8 bg-slate-200"></div>
        <div class="text-center">
          <span class="block text-slate-500 uppercase tracking-wider mb-1">Completion</span>
          <span id="compDate" class="font-bold text-rose-600">—</span>
        </div>
      </div>
    </div>

    <!-- Controls -->
    <div class="controls-panel">
      <div class="controls-left" id="controls">
        <input id="excelFile" type="file" accept=".xlsx,.xls,.csv" class="file-input" />
        <button id="loadBtn" class="btn-primary">Load Excel & Update</button>
        <button id="expandAllBtn" class="btn-secondary">Expand all</button>
        <button id="fitBtn" class="btn-secondary">Fit to screen</button>

        <div class="zoom-wrap" title="Zoom (month column width)">
          <span class="zoom-label">Zoom</span>
          <input id="zoomSlider" type="range" min="10" max="280" step="1" value="140" />
          <span id="zoomValue" class="zoom-value">140px/mo</span>
        </div>

        <div id="status" class="status">Ready.</div>
      </div>
    </div>

    <!-- Legend -->
    <div class="legend-panel" id="legendPanel">
      <!-- Legend source selector -->
      <div class="legend-item" style="gap:8px;">
        <span class="text-slate-500 text-[11px] uppercase tracking-widest font-semibold">Legend</span>
        <select id="legendSelect" class="px-2 py-1 rounded-md border border-slate-200 text-xs bg-white text-slate-700">
          <option value="auto">Auto (from file)</option>
          <option value="keywords">Keywords (fallback)</option>
        </select>
      </div>

      <!-- Dynamic legend items injected here -->
      <div id="legendItems" style="display:flex; gap:14px; flex-wrap:wrap;"></div>

      <!-- Always-present items -->
      <div class="legend-item"><span class="dot summary-dot"></span> Summary</div>
      <div class="legend-item"><span class="diamond"></span> Milestone</div>
    </div>

    <!-- Gantt Main -->
    <div class="gantt-wrap">
      <div class="gantt-split">
        <!-- Left pane -->
        <div id="leftPane" class="left-pane">
          <div class="left-header">Detailed Activity / WBS Element</div>
          <div id="labelRows" class="label-rows"></div>
        </div>

        <!-- Splitter -->
        <div id="splitter" class="splitter" title="Drag to resize"></div>

        <!-- Right pane (horizontal scroll only here) -->
        <div id="timelinePane" class="timeline-pane">
          <!-- Sticky timeline header (drag here to zoom) -->
          <div id="timelineHeader" class="timeline-header" title="Drag left/right here to zoom columns"></div>

          <!-- Bars -->
          <div id="barRows" class="bar-rows"></div>
        </div>
      </div>
    </div>

    <!-- Footer / Notes -->
    <div class="p-5 bg-slate-50 border-t border-slate-200 text-xs text-slate-600 leading-relaxed">
      Tip: If your Excel comes from copy/paste, ensure indentation is preserved (spaces before Activity ID / Activity Name).
      <span class="ml-2 text-slate-500">Click group rows to collapse/expand.</span>
    </div>
  </div>

  <script src="./app.js"></script>
</body>
</html>